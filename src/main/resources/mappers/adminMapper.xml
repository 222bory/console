<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
        
<mapper namespace="com.sicc.admin.demo.dao.AdminDao">

    <resultMap id="userResultMap" type="com.sicc.admin.demo.model.Member">
	    <id property="id" column="id" />
	    <result property="upw" column="upw"/>
	    <result property="uemail" column="uemail"/>
	    <collection property="roles" javaType="java.util.ArrayList" resultMap="roleMap"/>
	</resultMap>
	
	<resultMap id="roleMap" type="com.sicc.admin.demo.model.MemberRole">
	    <id property="rno" column="rno"/>
	    <result property="rolename" column="rolename"/>
	</resultMap>
    
    
    <select id="getUser" parameterType="String" resultType="com.sicc.admin.demo.model.User2">
    	SELECT * FROM test where username = #{username}
    </select>
    
    <select id="getMemberById" parameterType="String" resultType="com.sicc.admin.demo.model.Member">
    	SELECT admin_id as adminId, admin_nm as adminNm, admin_priv_cd as adminPrivCd, email_addr as emailAddr, password as password
    	  FROM 
    	   conadminm 
    	 WHERE admin_id = #{username} 
    </select>
    
    <insert id ="createMember" parameterType="com.sicc.admin.demo.model.Member">
    	insert into member (id, uid, upw, uemail, regdate, updatedate) values (#{id},#{uid},#{upw},#{uemail},null,null)
    </insert>
    
    <insert id ="createRole" parameterType="com.sicc.admin.demo.model.MemberRole">
    	insert into memberrole (rno, rolename) values (#{rno},#{rolename})
    </insert>
    
    <insert id ="createRelMemberRole" parameterType="com.sicc.admin.demo.model.MemberRoleRel">
    	insert into relmemberrole (uid, rno, member_role_rel_type_cd) values (#{uid},#{rno}, #{memberRoleRelTypeCd})
    </insert>

</mapper>
